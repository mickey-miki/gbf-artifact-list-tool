# グランブルーファンタジー アーティファクト取得ツール

このツールは、グランブルーファンタジー（GBF）のブラウザゲームからアーティファクトの一覧を取得するPythonスクリプトです。

## 機能

- 現在起動中のChromeブラウザからCookie情報を自動取得
- GBFのREST APIを使用してアーティファクトデータを取得
- Unicode文字列の自動デコード
- レアリティ、属性、レベル別の統計表示
- JSON形式でのデータ保存（生データと整形データの両方）

## 必要な環境

- Python 3.6以上
- Google Chrome ブラウザ
- 必要なPythonライブラリ：
  - selenium
  - requests

## インストール

1. 必要なライブラリをインストール：
```bash
pip install selenium requests
```

2. ChromeDriverのインストール（自動的に処理されます）

## 使用方法

### 準備

1. **Chromeをデバッグモードで起動**：
   ```bash
   chrome.exe --remote-debugging-port=9222
   ```
   
   または、既存のChromeを閉じてから上記コマンドで起動してください。

2. **GBFにログイン**：
   - ブラウザでGBFにアクセスしてログインしてください
   - アーティファクトページ（`https://game.granbluefantasy.jp/#list`）を開いておくと良いです

### 実行

```bash
python gbf_artifact_fetcher.py
```

### 実行オプション

スクリプト実行時に以下の選択肢があります：

1. **全ページ取得** (推奨)：
   - 全てのアーティファクトを取得します
   - 時間がかかりますが、完全なデータが取得できます

2. **1ページのみ取得**：
   - 最初の1ページ（通常20個程度）のみ取得します
   - 動作確認やテスト用に適しています

## 出力ファイル

実行後、以下のファイルが生成されます：

1. **`gbf_artifacts_raw.json`**：
   - APIから取得した生データ
   - 開発者向けの詳細情報を含む

2. **`gbf_artifacts_formatted.json`**：
   - 見やすく整形されたデータ
   - 一般ユーザー向けの形式

## データ構造

### 整形データの例

```json
{
  "index": 1,
  "id": 174531,
  "artifact_id": 301100101,
  "name": "オミナス・ストーン",
  "level": "1",
  "max_level": 5,
  "rarity": "3",
  "attribute": "土",
  "is_locked": false,
  "exp_info": {
    "next_exp": 30000,
    "remain_next_exp": 30000,
    "exp_width": 0
  },
  "skills": [
    {
      "skill_id": 30092,
      "name": "回避率",
      "level": 1,
      "quality": 2,
      "is_max_quality": false,
      "effect_value": "+4.8%",
      "icon_image": "bonus_28"
    }
  ],
  "equipped_to": false,
  "equip_details": []
}
```

## トラブルシューティング

### 1. Chromeブラウザへの接続に失敗する場合

**エラー**: `❌ Chromeブラウザへの接続に失敗しました`

**解決方法**:
- Chromeを完全に閉じてから、以下のコマンドで起動：
  ```bash
  chrome.exe --remote-debugging-port=9222
  ```
- ポート9222が使用中の場合は、別のポートを使用：
  ```bash
  chrome.exe --remote-debugging-port=9223
  ```
  その場合、スクリプト内の`debug_port`も変更してください。

### 2. UIDを自動取得できない場合

**エラー**: `⚠️ UIDを自動取得できませんでした`

**解決方法**:
1. **ブラウザのURLから確認**：
   - GBFのページのURLに`uid=数字`が含まれている場合があります
   
2. **開発者ツールのネットワークタブから確認**：
   - F12キーで開発者ツールを開く
   - Networkタブを選択
   - GBFでページを更新
   - `artifact/list`などのリクエストを探す
   - リクエストURLの`uid`パラメータを確認

3. **手動入力**：
   - スクリプト実行時にUIDの入力を求められた場合は、上記で確認したUIDを入力

### 3. APIリクエストが失敗する場合

**エラー**: `❌ APIリクエストが失敗しました: 403`

**解決方法**:
- GBFに正しくログインしているか確認
- Cookie情報が正しく取得されているか確認
- しばらく時間を置いてから再実行（レート制限の可能性）

**エラー**: `❌ APIリクエストが失敗しました: 401`

**解決方法**:
- セッションが期限切れの可能性があります
- GBFに再ログインしてから実行

### 4. データが取得できない場合

**症状**: `❌ アーティファクトデータを取得できませんでした`

**確認事項**:
1. GBFにログインしているか
2. アーティファクトページが正しく表示されているか
3. ネットワーク接続が安定しているか
4. GBFのメンテナンス中でないか

## 注意事項

1. **利用規約の遵守**：
   - このツールはGBFの利用規約に従って使用してください
   - 過度なAPIアクセスは避けてください

2. **個人情報の取り扱い**：
   - 生成されるJSONファイルには個人のゲームデータが含まれます
   - ファイルの共有や公開には注意してください

3. **レート制限**：
   - APIアクセスには適切な間隔を設けています
   - 連続実行は避けてください

## ライセンス

このツールは個人利用目的で作成されています。商用利用や再配布については制限があります。

## サポート

問題が発生した場合は、以下の情報を含めて報告してください：
- エラーメッセージの全文
- 実行環境（OS、Pythonバージョン、Chromeバージョン）
- 実行時の状況（GBFのログイン状態など）
